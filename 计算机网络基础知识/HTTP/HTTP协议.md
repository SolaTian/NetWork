# 2、`HTTP`协议

`HTTP`协议用于客户端和服务端的通信，其组成有下：

1. `HTTP`协议的请求报文由请求方法，请求`URI`，协议版本，可选的请求首部字段和内容实体构成；
2. `HTTP`协议的响应报文由协议版本，状态码，解释状态码的原因短语，可选的响应首部字段以及内容实体构成。

## 2.1、`HTTP`协议部分特性

1. `HTTP`协议是不保存状态的协议，无状态协议，`HTTP`不对发送过的请求和响应做持久化处理，不保留之前的信息；
2. `HTTP`请求`URI`可以使用完整的请求`URI`，也可以在首部的`Host`中写明网络域名或`IP地址`；
3. 若对服务器资源直接发起请求，可以使用一个`*`来代替`URI`，对服务器本身发起请求。

## 2.2、`HTTP`方法
|`HTTP/1.1`中可使用的方法|说明|
|-|-|
|`GET`|用来请求访问已经被`URI`识别的资源，指定的资源经服务器端解析后返回响应内容<li>如果请求的是文本，则保持原样返回；<li>如果请求的是`CGI`程序，则返回执行后的输出结果|
|`POST`|用来传输实体的主体|
|`PUT`|传输文件，要求在请求的报文的主体中包含文件内容，然后保存到请求`URI`指定的位置，不带验证机制，存在安全性问题|
|`HEAD`|与`GET`方法一样，但是不返回报文主体部分。用于确认`URI`的有效性以及资源更新的日期时间等|
|`DELETE`|与`PUT`相反的方法，用来删除文件，同样也不带验证机制|
|`OPTIONS`（`HTTP/1.1`新增）|查询针对请求`URI`指定的资源支持的方法|
|`TRACE`（`HTTP/1.1`新增）|让`Web`服务器将之前的请求通信返回给客户端的方法，使用`TRACE`方法可以查询发送出去的请求是被如何加工修改的，通常不会使用。|
|`CONNECT`（`HTTP/1.1`新增）|要求在与代理服务器通信时建立隧道，实现用隧道协议进行`TCP`通信。<li>主要使用`SSL`和`TLS`把通信内容加密后经网络隧道传输。|


## 2.3、`HTTP/1.1`的持久连接与管线化

`HTTP`持久连接(`HTTP/1.1`和部分`HTTP/1.0`)，也叫做`HTTP keep-alive`方法。特点是只要任意一段端没有明确提出断开连接，则保持`TCP`连接状态。

`HTTP/1.1`持久连接的优点：
- 减少了`TCP`连接的重复建立和断开所造成的额外开销，减轻了服务器端的负载；
- `HTTP`响应和请求可以更早结束，`Web`页面显示速度提高；
- 持续连接可以使多数请求以`管线化`方式发送成为可能，可以同时并行发送一个一个请求，不需要一个一个等待响应，`管线化`连接比持久连接还要快，请求数越多，时间差就越明显。


## 2.4、使用`Cookie`的状态管理

`HTTP`是无状态协议，不对之前发生过的请求和响应的状态进行管理，无法根据之前的状态进行本次的请求处理。

如果要求登录验证的`Web`页面本身无法进行状态管理(不记录已经登录的状态)，则每次跳转新的页面都会要求再次登录，或者要在每次请求的报文里面附加参数来管理登录状态。

引入`Cookie`技术，`Cookie`技术在请求和响应报文中写入`Cookie`信息来控制客户端的状态。

`Cookie`的工作机制：
- `Cookie`会根据从服务器端发送的响应报文里的一个`Set-Cookie`首部字段，通知客户端保存`Cookie`；
- 当下次客户端再向该服务器发送请求时，会自动在请求报文中加入`Cookie`值发出去;
- 服务器端一旦发现客户端发过来的`Cookie`，会去检查从哪个客户端上发来的连接请求，然后对比服务器记录，最后得到之前的状态信息。

