# 9、基于`HTTP`新增的功能追加协议

起初`HTTP`是用来当做传输`HTML`文档的协议，现在`Web`上的用途很多，但是由于`HTTP`自身的限制，导致这些`Web`应用性能不是最优。

## 9.1、`SPDY`

> `SPDY`是谷歌开发，旨在解决`HTTP`的性能瓶颈，缩短`Web`页面的加载时间。

**<font size =4 color = red>`HTTP`的瓶颈</font>**

在一些社交网站上，比如`Facebook`，`Twitter`这种，每秒有大量的数据内容更新，要想实时的反馈到客户端的界面上，使用`HTTP`就必须频繁的从客户端到服务器端进行确认。且如果服务器上面没有更新，就会产生无用的通信。

若想要实现所需功能，`HTTP`就会存在以下标准：

- 一条连接上只可以发送一个请求
- 请求只能从客户端开始，客户端不可以接受除响应以外的指令
- 请求/响应首部未经压缩就发送，首部信息越多延迟越大
- 发送冗长的首部。每次互相发送相同的首部造成的浪费较多。
- 可任意选择数据压缩格式，非强制发送。


部分解决方法：
1. `Ajax`(异步`JavaScript`与`XML`技术)从已经加载的页面上发起请求，只更新局部页面。但是实时地从服务器获取内容，又可能会导致大量请求的产生。仍然未解决`HTTP`协议本身存在的问题。
2. `Comet`在检测到服务器有更新时，不会等待请求，而是直接向客户端返回响应。是一种通过延迟应答，模拟实现服务器向客户端推送的功能。为了实现推送功能，`Comet`会将响应处于挂起状态，当服务器端有内容更新时，再返回该响应，因此可以做到有更新立刻反馈给客户端。但是为了维持一次连接的时间变长了，会消耗很多资源。也仍未解决`HTTP`协议本身的问题。

`SPDY`以会话层的形式加入`HTTP`和`TCP/IP`之间，同时表示层规定使用`SSL`。在协议级别消除`HTTP`的瓶颈，可以实现：
- 多路复用：一个`TCP/IP`连接可以无限制处理多个`HTTP`请求。
- 赋予各个请求优先级：解决带宽低而导致响应变慢的问题。
- 压缩`HTTP`首部：通信产生的数据包的数量和发送的字节数就变少了。
- 推送功能：支持服务器主动向客户端推送数据的功能。
- 服务器提示功能：服务器主动提示客户端请求所需要的资源。避免发送不必要的请求。

## 9.2、`WebSocket`

`WebSocket`，即`Web`浏览器和`Web`服务器之间全双工通信标准。一旦确立`WebSocket`的连接，不论是服务端还是客户端，任意一方都可以直接向对方发送报文。

主要特点：
- 推送功能，服务端直接向客户端推送，不必等待客户端的请求。
- 减少通信量，`WebSocket`的首部信息很小，通信量减少，且WebSocket一旦建立连接，就希望一直保持连接状态。

为了实现`WebSocket`，需要完成一次握手操作：
- 在握手请求中，需要用到`HTTP`的`Upgrade`字段，告知服务器通信协议发生改变。达到握手目的。首部字段`Sec-WebSocket-Key`记录握手过程中的键值，`Sec-WebSocket-Protocol`记录使用的子协议。
- 在握手响应中，对于之前的请求，返回`101 Switching Protocols`的响应。`Sec-WebSocket-Accept`的字段值是由握手请求中的`Sec-WebSocket-Key`字段生成的。成功握手确立`WebSocket`连接之后，通信时不再使用`HTTP`数据帧，而采用`WebSocket`独立的数据帧。


`WebSocket`有属于自己的一套`API`，可以在`JavaScript`中调用。

## 9.3、`HTTP/2.0`

主要围绕以下技术进行讨论：

- 多路复用
- `TLS`义务化
- 协商
- 流量控制
- `WebSocket`等



## 9.4、`Web`服务器管理文件的`WebDAV`

> `WebDAV`：是一个可以对`Web`服务器上的内容直接进行文件复制、编辑等操作的分布式文件系统，包括`WebDAV`请求和`WebDAV`响应。

`WebDAV`在`HTTP/1.1`的基础上新增了一些方法和状态码。
